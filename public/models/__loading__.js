function onSceneLoaded(){window.parent.postMessage(JSON.stringify({message:"sceneLoaded"}),"*")}var canvas,devices,app,CANVAS_ID="application-canvas",createCanvas=function(){return canvas=document.createElement("canvas"),canvas.setAttribute("id",CANVAS_ID),canvas.setAttribute("tabindex",0),canvas.onselectstart=function(){return!1},document.body.appendChild(canvas),canvas},createInputDevices=function(e){var a={elementInput:new pc.ElementInput(e,{useMouse:INPUT_SETTINGS.useMouse,useTouch:INPUT_SETTINGS.useTouch}),keyboard:INPUT_SETTINGS.useKeyboard?new pc.Keyboard(window):null,mouse:INPUT_SETTINGS.useMouse?new pc.Mouse(e):null,gamepads:INPUT_SETTINGS.useGamepads?new pc.GamePads():null,touch:INPUT_SETTINGS.useTouch&&pc.platform.touch?new pc.TouchDevice(e):null};return a},configureCss=function(e,a,n){canvas.classList&&canvas.classList.add("fill-mode-"+e);var t="@media screen and (min-aspect-ratio: "+a+"/"+n+") {";t+="    #application-canvas.fill-mode-KEEP_ASPECT {",t+="        width: auto;",t+="        height: 100%;",t+="        margin: 0 auto;",t+="    }",t+="}",document.head.querySelector&&(document.head.querySelector("style").innerHTML+=t)},reflow=function(){app.resizeCanvas(canvas.width,canvas.height),canvas.style.width="",canvas.style.height="";var e=app._fillMode;e!=pc.FILLMODE_NONE&&e!=pc.FILLMODE_KEEP_ASPECT||(e==pc.FILLMODE_NONE&&canvas.clientHeight<window.innerHeight||canvas.clientWidth/canvas.clientHeight>=window.innerWidth/window.innerHeight?canvas.style.marginTop=Math.floor((window.innerHeight-canvas.clientHeight)/2)+"px":canvas.style.marginTop="")},displayError=function(e){var a=document.createElement("div");a.innerHTML=['<table style="background-color: #8CE; width: 100%; height: 100%;">',"  <tr>",'      <td align="center">','          <div style="display: table-cell; vertical-align: middle;">','              <div style="">'+e+"</div>","          </div>","      </td>","  </tr>","</table>"].join("\n"),document.body.appendChild(a)};canvas=createCanvas(),devices=createInputDevices(canvas),function(){try{app=new pc.Application(canvas,{elementInput:devices.elementInput,keyboard:devices.keyboard,mouse:devices.mouse,gamepads:devices.gamepads,touch:devices.touch,graphicsDeviceOptions:window.CONTEXT_OPTIONS,assetPrefix:window.ASSET_PREFIX||"",scriptPrefix:window.SCRIPT_PREFIX||"",scriptsOrder:window.SCRIPTS||[]})}catch(e){return void(e instanceof pc.UnsupportedBrowserError?displayError('This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to find out more.</a>'):e instanceof pc.ContextCreationError?displayError('It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>'):displayError("Could not initialize application. Error: "+e))}}();var configure=function(){app.configure(CONFIG_FILENAME,function(e){e&&console.error(e),configureCss(app._fillMode,app._width,app._height),setTimeout(function(){reflow(),window.addEventListener("resize",reflow,!1),window.addEventListener("orientationchange",reflow,!1),app.preload(function(e){e&&console.error(e),app.loadScene(SCENE_PATH,function(e,a){e&&console.error(e),app.start(),window.parent.postMessage(JSON.stringify({message:"engineLoaded"}),"*")})})})})},loadEngine2=function(){PRELOAD_MODULES.length>0?loadModules(PRELOAD_MODULES,ASSET_PREFIX,configure):configure()};pc.script.createLoadingScreen(function(e){var a=function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e)},n=function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)},t=function(e){e=Math.min(1,Math.max(0,e)),window.localStorage.setItem("engineLoadProgress",e),window.parent.postMessage(JSON.stringify({message:"engineLoadProgress",payload:e}),"*")},o=function(){var e=["body {","    background-color: #c8c8c8;","}","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #c8c8c8;","}","#application-splash {","    position: absolute;","    top: calc(50% - 28px);","    width: 264px;","    left: calc(50% - 132px);","}","#application-splash img {","    width: 100%;","}","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #c8c8c8;","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e)),document.head.appendChild(a)};o(),a(),e.on("preload:end",function(){e.off("preload:progress")}),e.on("preload:progress",t),e.on("start",n)}),app.on("sceneLoaded",onSceneLoaded),loadEngine2(),window.addEventListener("message",function(e){var a=JSON.parse(e.data);"reset"===a.message?app.fire("reset"):"infill"===a.message?app.fire("infill",a.payload):"setWhite"===a.message?app.fire("setWhite",a.payload):"setQuality"===a.message?app.fire("setQuality",a.payload):"showStand"===a.message?app.fire("showStand",a.payload):"setNormalStand"===a.message&&app.fire("setNormalStand",a.payload)}),window.parent.postMessage(JSON.stringify({message:"scriptLoaded"}),"*");